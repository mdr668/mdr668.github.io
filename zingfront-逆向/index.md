# 

# zingfront 逆向笔记

确定参数来源

拼接组装待加密的参数:
```
2825b4500  0a 0b 69 50 68 6f 6e 65 20 31 33 2e 37 12 12 61  ..iPhone 13.7..a
2825b4510  66 6d 61 2d 73 64 6b 2d 69 2d 76 37 2e 36 39 2e  fma-sdk-i-v7.69.
2825b4520  30 c8 01 a4 c5 cd 98 06 18 1e 28 03 30 64 20 00  0.........(.0d .
2825b4530  88 01 00 b8 01 a4 c5 cd 98 06 58 01 60 01 b0 01  ..........X.`...
2825b4540  01 98 01 00 f8 01 da 09 80 02 a0 11 88 02 80 0f  ................
2825b4550  92 02 03 31 2e 30 a0 04 02 f2 02 0d 6d 64 72 2e  ...1.0......mdr.
2825b4560  7a 69 6e 67 66 72 6f 6e 74 c8 04 01 00 00 00 00  zingfront.......
```
数据格式为protobuf
```
{
    "0": [
        0,
        0
    ],
    "1": "iPhone 13.7",
    "2": {
        "12": 7380662212167495000,
        "13": 3275866450576355000 ///解析错误 应该为:afma-sdk-i-v7.69.0
    },
    "3": 55,
    "4": 1,
    "5": 3,
    "6": 100,
    "11": 1,
    "12": 1,
    "17": 1,
    "19": 0,
    "22": 1,
    "23": 1662274211,
    "25": 1662274211,
    "31": 1242,
    "32": 2208,
    "33": 1920,
    "34": "1.0",
    "46": "mdr.zingfront",
    "68": 2,
    "73": 1
}
```
ggi_ged 0x9C724 加密入口
入参:
```
call:,RewardedVideoExample,0x9c724==========================
,arg0:            0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
2825b4500  0a 0b 69 50 68 6f 6e 65 20 31 33 2e 37 12 12 61  ..iPhone 13.7..a
2825b4510  66 6d 61 2d 73 64 6b 2d 69 2d 76 37 2e 36 39 2e  fma-sdk-i-v7.69.
2825b4520  30 c8 01 a4 c5 cd 98 06 18 1e 28 03 30 64 20 00  0.........(.0d .
2825b4530  88 01 00 b8 01 a4 c5 cd 98 06 58 01 60 01 b0 01  ..........X.`...
2825b4540  01 98 01 00 f8 01 da 09 80 02 a0 11 88 02 80 0f  ................
2825b4550  92 02 03 31 2e 30 a0 04 02 f2 02 0d 6d 64 72 2e  ...1.0......mdr.
2825b4560  7a 69 6e 67 66 72 6f 6e 74 c8 04 01 00 00 00 00  zingfront.......
,arg1:0x6c
,arg2:0x0
```

出参:
```
retval:fBiZAnYYId0YBTGaOa9sY4-Zqb-YQz-icux8Ra6G_b8aNrUnRDEMgJq5OXqDShD5QibOsQp-c345cXRoG9XhhpQoU8FDfMFU71lpYMyeWSHwBTHA_JMpAn7eJfy90A1RG7LFgTQSE_Iqxnm2f-cUS2IRFZC-D7ipMe-MFJR-69UA4pAKAdp_eSDGXM_VJeJ8_TkocFTwWzpeIHPvMRPv9S8opMBouDlBxLmQXszBX25Ci9k5LrJMvqUb3k_Satc-qv2itlVvyHgfD52MSNii0aTNQSb57Wt_x_KToBXPX84CBUxmJPigxe5BUVUNd6SKtZjZ6sUHKkkrgS7ViZQK5g
```

加密流程
1. 开头插入字节码长度 0x6C ,字节码结束的位置补齐随机数到0xF0

```
283b554a0  6c 0a 0b 69 50 68 6f 6e 65 20 31 33 2e 37 12 12  l..iPhone 13.7..
283b554b0  61 66 6d 61 2d 73 64 6b 2d 69 2d 76 37 2e 36 39  afma-sdk-i-v7.69
283b554c0  2e 30 c8 01 f9 c9 d0 98 06 18 11 28 03 30 64 20  .0.........(.0d 
283b554d0  00 88 01 00 b8 01 f9 c9 d0 98 06 58 01 60 01 b0  ...........X.`..
283b554e0  01 01 98 01 00 f8 01 da 09 80 02 a0 11 88 02 80  ................
283b554f0  0f 92 02 03 31 2e 30 a0 04 02 f2 02 0d 6d 64 72  ....1.0......mdr
283b55500  2e 7a 69 6e 67 66 72 6f 6e 74 c8 04 01 55 64 81  .zingfront...Ud.
283b55510  d8 e9 2e ab d6 68 93 f4 c8 2c 50 76 a0 8f 63 1f  .....h...,Pv..c.
283b55520  66 83 42 9f 31 4a 6e 78 07 48 1f 4d 50 2e a6 95  f.B.1Jnx.H.MP...
283b55530  5f 13 c7 75 79 d0 f4 70 97 d8 78 d4 05 3e 68 63  _..uy..p..x..>hc
283b55540  54 d4 59 9d 9b b4 a7 be 48 1e 8b 6a e2 62 81 ec  T.Y.....H..j.b..
283b55550  58 77 09 97 1e 79 54 a5 04 07 f9 2d e2 24 02 e3  Xw...yT....-.$..
283b55560  a9 e1 85 2a 5f e5 ec 01 5a 63 3c 73 2c 61 65 df  ...*_...Zc<s,ae.
283b55570  76 37 6b c3 60 2f 02 69 70 60 26 87 f2 62 30 af  v7k.`/.ip`&..b0.
283b55580  02 30 80 d4 80 32 bc 3c 04 47 eb 00 09 82 a4 2f  .0...2.<.G...../
```

1. 整体做 MD5 结果16个字节插入字节码起始位置
```
283883000  1c cd 55 06 5d 1a 23 5b f2 f6 96 3c 2c fc 42 c6  ..U.].#[...<,.B.
283883010  6c 0a 0b 69 50 68 6f 6e 65 20 31 33 2e 37 12 12  l..iPhone 13.7..
283883020  61 66 6d 61 2d 73 64 6b 2d 69 2d 76 37 2e 36 39  afma-sdk-i-v7.69
283883030  2e 30 c8 01 bd d3 cd 98 06 18 1d 28 03 30 64 20  .0.........(.0d 
283883040  00 88 01 00 b8 01 bd d3 cd 98 06 58 01 60 01 b0  ...........X.`..
283883050  01 01 98 01 00 f8 01 da 09 80 02 a0 11 88 02 80  ................
283883060  0f 92 02 03 31 2e 30 a0 04 02 f2 02 0d 6d 64 72  ....1.0......mdr
283883070  2e 7a 69 6e 67 66 72 6f 6e 74 c8 04 01 38 0e c9  .zingfront...8..
283883080  9f 0a bf 08 f2 5b 25 c8 63 bb 5a a4 93 22 f9 eb  .....[%.c.Z.."..
283883090  37 f1 6f 3e 23 35 22 e0 43 5a d2 60 4c 57 dc e4  7.o>#5".CZ.`LW..
2838830a0  f7 67 05 61 f4 98 aa 82 0f 80 64 9a 7d 1c 88 b4  .g.a......d.}...
2838830b0  df 3b 65 78 f4 71 53 43 0e 4f 34 ce 8a b9 30 af  .;ex.qSC.O4...0.
2838830c0  f4 bc f1 fe e9 54 c8 07 f1 46 a8 cc 6f 23 7e 50  .....T...F..o#~P
2838830d0  2c 0d d1 e8 e9 ee f2 f2 a6 51 0f 45 34 16 90 78  ,........Q.E4..x
2838830e0  50 df e1 30 dc 1f ea ed b7 4b aa 88 e0 17 7e 6e  P..0.....K....~n
```
1. 12轮异或加密
2. base64编码

gdhf_ghf 0xEE0EC md5生成16字节插入第一行
入参:
```
call:,RewardedVideoExample,0xee0ec==========================
,arg0:            0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
283b554a0  6c 0a 0b 69 50 68 6f 6e 65 20 31 33 2e 37 12 12  l..iPhone 13.7..
283b554b0  61 66 6d 61 2d 73 64 6b 2d 69 2d 76 37 2e 36 39  afma-sdk-i-v7.69
283b554c0  2e 30 c8 01 f9 c9 d0 98 06 18 11 28 03 30 64 20  .0.........(.0d 
283b554d0  00 88 01 00 b8 01 f9 c9 d0 98 06 58 01 60 01 b0  ...........X.`..
283b554e0  01 01 98 01 00 f8 01 da 09 80 02 a0 11 88 02 80  ................
283b554f0  0f 92 02 03 31 2e 30 a0 04 02 f2 02 0d 6d 64 72  ....1.0......mdr
283b55500  2e 7a 69 6e 67 66 72 6f 6e 74 c8 04 01 55 64 81  .zingfront...Ud.
283b55510  d8 e9 2e ab d6 68 93 f4 c8 2c 50 76 a0 8f 63 1f  .....h...,Pv..c.
283b55520  66 83 42 9f 31 4a 6e 78 07 48 1f 4d 50 2e a6 95  f.B.1Jnx.H.MP...
283b55530  5f 13 c7 75 79 d0 f4 70 97 d8 78 d4 05 3e 68 63  _..uy..p..x..>hc
283b55540  54 d4 59 9d 9b b4 a7 be 48 1e 8b 6a e2 62 81 ec  T.Y.....H..j.b..
283b55550  58 77 09 97 1e 79 54 a5 04 07 f9 2d e2 24 02 e3  Xw...yT....-.$..
283b55560  a9 e1 85 2a 5f e5 ec 01 5a 63 3c 73 2c 61 65 df  ...*_...Zc<s,ae.
283b55570  76 37 6b c3 60 2f 02 69 70 60 26 87 f2 62 30 af  v7k.`/.ip`&..b0.
283b55580  02 30 80 d4 80 32 bc 3c 04 47 eb 00 09 82 a4 2f  .0...2.<.G...../
,arg1:0xf0
```

出参:
```
,retval retval:            0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
16f9c27e8  e2 8e c4 c8 c9 dc 4a 3e 70 4f 67 50 3a 8f 19 89  ......J>pOgP:...
```

第二行起始写入长度 0x6C 后拼接入参
0x6d之后使用rand生成随机数填充到0xf0长度

0x9CBE8 调用 gad_bs 0x9E44C 12轮异或加密
```
[iPhone::mdr.zingfront]-> call:,RewardedVideoExample,0x9e44c==========================
,arg0:            0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
283883000  1c cd 55 06 5d 1a 23 5b f2 f6 96 3c 2c fc 42 c6  ..U.].#[...<,.B.
283883010  6c 0a 0b 69 50 68 6f 6e 65 20 31 33 2e 37 12 12  l..iPhone 13.7..
283883020  61 66 6d 61 2d 73 64 6b 2d 69 2d 76 37 2e 36 39  afma-sdk-i-v7.69
283883030  2e 30 c8 01 bd d3 cd 98 06 18 1d 28 03 30 64 20  .0.........(.0d 
283883040  00 88 01 00 b8 01 bd d3 cd 98 06 58 01 60 01 b0  ...........X.`..
283883050  01 01 98 01 00 f8 01 da 09 80 02 a0 11 88 02 80  ................
283883060  0f 92 02 03 31 2e 30 a0 04 02 f2 02 0d 6d 64 72  ....1.0......mdr
283883070  2e 7a 69 6e 67 66 72 6f 6e 74 c8 04 01 38 0e c9  .zingfront...8..
283883080  9f 0a bf 08 f2 5b 25 c8 63 bb 5a a4 93 22 f9 eb  .....[%.c.Z.."..
283883090  37 f1 6f 3e 23 35 22 e0 43 5a d2 60 4c 57 dc e4  7.o>#5".CZ.`LW..
2838830a0  f7 67 05 61 f4 98 aa 82 0f 80 64 9a 7d 1c 88 b4  .g.a......d.}...
2838830b0  df 3b 65 78 f4 71 53 43 0e 4f 34 ce 8a b9 30 af  .;ex.qSC.O4...0.
2838830c0  f4 bc f1 fe e9 54 c8 07 f1 46 a8 cc 6f 23 7e 50  .....T...F..o#~P
2838830d0  2c 0d d1 e8 e9 ee f2 f2 a6 51 0f 45 34 16 90 78  ,........Q.E4..x
2838830e0  50 df e1 30 dc 1f ea ed b7 4b aa 88 e0 17 7e 6e  P..0.....K....~n
2838830f0  10 d6 ae 18 87 dc 94 ca e8 a0 33 5d 23 56 e9 ad  ..........3]#V..
```
返回的结果结果为 _ggu_gad_gwse 0x00EDD1C base64生成 A-Za-z0-9-_格式

---

> 作者: [mdr](https://github.com/mdr668)  
> URL: /zingfront-%E9%80%86%E5%90%91/  

